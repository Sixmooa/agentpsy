# 项目日志：Project WeMBTI

**项目代号：** `Project WeMBTI`
**目标：** 将静态网页版 MBTI 测试项目，重构并迁移为一个功能完善的Android APP。
**后端服务：** Supabase
**核心原则：** TDD, KISS, YAGNI, SOLID, BMAND, kiros spec

---

## 开发任务清单

### 第一阶段：项目初始化与后端设置

- [ ] **环境搭建**
    - [ ] 查看项目的环境配置。
    - [ ] 初始化项目，配置好基本的目录结构。
    - [ ] 集成 Supabase的 JavaScript 客户端库 (`supabase-js`)。
- [ ] **Superbase后端设置**
    - [ ] 在 Supabase平台上创建新项目。
    - [ ] **数据库设计与创建：**
        - [ ] 创建 `questions` 题目表。
        - [ ] 创建 `options` 选项表
        - [ ] 创建 `test_results` 表。
        - [ ] 创建 `user_answers` 表。
        - [ ] 创建 `mbti_types_info` 表。
    - [ ] **数据迁移：**
        - [ ] 分析 `js/data.js` 中的题目数据。
        - [ ] 编写并执行一次性脚本，将题目批量导入到 `questions` 和 `options` 表。
        - [ ] 提取 `content/*.html` 的内容，整理并导入到 `mbti_types_info` 表。

### 第二阶段：核心功能开发 - 答题流程

- [ ] **题目获取 (TDD)**
    - [ ] **Test:** 编写测试用例，验证随机获取题目的功能。
    - [ ] **Implement:** 创建 `fetchRandomQuestions()` 函数，实现从数据库高效随机抽取题目。
- [ ] **答题界面**
    - [ ] 创建答题页面 `pages/test/test`。
    - [ ] 实现题目展示和用户交互逻辑。
    - [ ] 一个界面中仅允许出现一道题。
    - [ ] 记录用户的答案。
- [ ] **结果计算**
    - [ ] 实现 MBTI 四个维度的分数计算逻辑。
    - [ ] 根据分数确定最终的 MBTI 类型。

### 第三阶段：用户认证与数据保存

- [ ] **多方式登录 (TDD)**
    - [ ] **Test:** 为邮箱、GitHub、微信登录编写测试用例。
    - [ ] **Implement:** 实现邮箱/密码登录功能。
    - [ ] **Implement:** 实现 GitHub OAuth 登录功能。
    - [ ] **Implement:** 创建 Supabase Edge Function 以处理微信登录逻辑。
    - [ ] **Implement:** 完成小程序端与 Edge Function 的对接，实现微信登录。
- [ ] **数据持久化**
    - [ ] 将登录用户的测试结果和答案保存到数据库。
    - [ ] 支持匿名测试，并在结束后提示登录以保存记录。
    - [ ] 开发个测试接口，不需要登录，将其测试结果保存到用户ID为1的

### 第四阶段：结果展示与高级功能

- [ ] **结果页面**
    - [ ] 创建结果页面 `pages/result/result`。
    - [ ] 展示 MBTI 类型、得分雷达图和详细分析。
- [ ] **结果导出为图片 (TDD)**
    - [ ] **Test:** 编写测试用例，验证 Canvas 绘制及图片生成功能。
    - [ ] **Implement:** 使用 `<canvas>` 动态绘制结果。
    - [ ] **Implement:** 实现“保存为图片”功能。
- [ ] **历史记录**
    - [ ] 在“我的”页面，展示已登录用户的历史测试记录。
    - [ ] 实现点击历史记录跳转到对应结果页面的功能。

### 第五阶段：测试、优化与部署

- [ ] **全面测试:**
    - [ ] 执行所有单元测试和集成测试。
    - [ ] 进行手动测试，确保流程顺畅，UI/UX 良好。
    - [ ] 测试成功率要达到100%
- [ ] **代码审查与重构:**
    - [ ] 审查所有代码，确保符合 SOLID、KISS 等原则。
    - [ ] 移除无用代码，优化性能。
- [ ] **部署准备:**
    - [ ] 准备好微信小程序的发布流程。
    - [ ] 最终确认 Supabase的配置（如 RLS - Row Level Security）。





注：1.若修改了配置，必须提醒我是否要进行 `sync Project with gradle files` ，
   2.请仔细阅读工作日志。
   2.修改代码后要写好工作日志。
